<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Genesis Playroom - Finger Painting</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      touch-action: none;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
    }

    body {
      font-family: 'Comic Sans MS', 'Chalkboard', cursive, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      overflow: hidden;
    }

    .playroom-container {
      display: flex;
      flex-direction: column;
      height: 100vh;
      padding: 10px;
      gap: 10px;
    }

    /* Header */
    .playroom-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background: rgba(255,255,255,0.95);
      border-radius: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .playroom-title {
      font-size: 1.8rem;
      color: #764ba2;
      text-shadow: 2px 2px 0 #FFE066;
    }

    .artist-name {
      font-size: 1rem;
      color: #666;
    }

    .artist-name input {
      border: 2px dashed #ccc;
      border-radius: 10px;
      padding: 5px 10px;
      font-family: inherit;
      font-size: 1rem;
      width: 150px;
    }

    /* Canvas Area */
    .canvas-wrapper {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      background: rgba(255,255,255,0.3);
      border-radius: 20px;
      padding: 10px;
    }

    #playroom-canvas {
      background: #FFFFFF;
      border-radius: 15px;
      box-shadow:
        0 10px 40px rgba(0,0,0,0.3),
        inset 0 0 0 3px rgba(255,255,255,0.5);
      cursor: crosshair;
      max-width: 100%;
      max-height: 100%;
    }

    /* Controls */
    .controls {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }

    /* Color Palette */
    .color-palette {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: center;
      padding: 15px;
      background: rgba(255,255,255,0.95);
      border-radius: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .color-btn {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: 4px solid white;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    }

    .color-btn:hover {
      transform: scale(1.15);
    }

    .color-btn.active {
      transform: scale(1.2);
      box-shadow: 0 0 0 4px #764ba2, 0 5px 20px rgba(0,0,0,0.3);
    }

    /* Brush Sizes */
    .brush-panel {
      display: flex;
      gap: 10px;
      align-items: center;
      padding: 15px;
      background: rgba(255,255,255,0.95);
      border-radius: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .brush-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: 3px solid #ddd;
      background: white;
      cursor: pointer;
      transition: all 0.2s;
    }

    .brush-btn:hover {
      border-color: #764ba2;
      transform: scale(1.1);
    }

    .brush-btn.active {
      border-color: #764ba2;
      background: #f0e6ff;
      box-shadow: 0 0 0 3px rgba(118, 75, 162, 0.3);
    }

    .brush-dot {
      border-radius: 50%;
      background: #333;
    }

    /* Action Buttons */
    .action-panel {
      display: flex;
      gap: 10px;
      padding: 15px;
      background: rgba(255,255,255,0.95);
      border-radius: 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .action-btn {
      padding: 12px 25px;
      font-size: 1.1rem;
      font-family: inherit;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      transition: all 0.2s;
      font-weight: bold;
    }

    .action-btn:hover {
      transform: scale(1.05);
    }

    .btn-undo {
      background: #74C0FC;
      color: white;
    }

    .btn-clear {
      background: #FF6B6B;
      color: white;
    }

    .btn-save {
      background: #69DB7C;
      color: white;
    }

    .btn-new {
      background: #B197FC;
      color: white;
    }

    /* Fun animations */
    @keyframes rainbow {
      0% { filter: hue-rotate(0deg); }
      100% { filter: hue-rotate(360deg); }
    }

    .rainbow-mode .playroom-title {
      animation: rainbow 3s linear infinite;
    }

    /* Splash effect */
    .splash {
      position: fixed;
      pointer-events: none;
      border-radius: 50%;
      animation: splash 0.6s ease-out forwards;
    }

    @keyframes splash {
      0% {
        transform: scale(0);
        opacity: 0.8;
      }
      100% {
        transform: scale(2);
        opacity: 0;
      }
    }

    /* Mobile adjustments */
    @media (max-width: 768px) {
      .playroom-header {
        flex-direction: column;
        gap: 10px;
      }

      .playroom-title {
        font-size: 1.4rem;
      }

      .color-btn {
        width: 40px;
        height: 40px;
      }

      .brush-btn {
        width: 40px;
        height: 40px;
      }

      .action-btn {
        padding: 10px 15px;
        font-size: 0.9rem;
      }
    }

    /* Instructions tooltip */
    .instructions {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 15px 20px;
      border-radius: 15px;
      font-size: 0.9rem;
      max-width: 250px;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .instructions.visible {
      opacity: 1;
    }

    .help-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: #FFE066;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      z-index: 100;
    }
  </style>
</head>
<body>
  <div class="playroom-container">
    <!-- Header -->
    <header class="playroom-header">
      <h1 class="playroom-title">Genesis Playroom</h1>
      <div class="artist-name">
        Artist: <input type="text" id="artistName" value="Little Artist" placeholder="Your name">
      </div>
    </header>

    <!-- Canvas -->
    <div class="canvas-wrapper">
      <canvas id="playroom-canvas" width="900" height="500"></canvas>
    </div>

    <!-- Controls -->
    <div class="controls">
      <!-- Color Palette -->
      <div class="color-palette" id="colorPalette">
        <!-- Colors injected by JS -->
      </div>

      <!-- Brush Sizes -->
      <div class="brush-panel" id="brushPanel">
        <!-- Brushes injected by JS -->
      </div>

      <!-- Actions -->
      <div class="action-panel">
        <button class="action-btn btn-undo" id="undoBtn">Undo</button>
        <button class="action-btn btn-clear" id="clearBtn">Clear</button>
        <button class="action-btn btn-save" id="saveBtn">Save</button>
        <button class="action-btn btn-new" id="newBtn">New</button>
      </div>
    </div>
  </div>

  <button class="help-btn" id="helpBtn">?</button>

  <div class="instructions" id="instructions">
    <strong>How to Paint:</strong><br>
    - Touch or click and drag to paint!<br>
    - Pick colors from the palette<br>
    - Choose brush sizes<br>
    - Have fun creating!
  </div>

  <script>
    // ═══════════════════════════════════════════════════════════════════════
    // GENESIS PLAYROOM - Finger Painting Engine
    // ═══════════════════════════════════════════════════════════════════════

    const COLORS = [
      { name: "Cherry Red", hex: "#FF6B6B" },
      { name: "Sunset Orange", hex: "#FFA94D" },
      { name: "Sunshine Yellow", hex: "#FFE066" },
      { name: "Grass Green", hex: "#69DB7C" },
      { name: "Sky Blue", hex: "#74C0FC" },
      { name: "Grape Purple", hex: "#B197FC" },
      { name: "Bubblegum Pink", hex: "#F783AC" },
      { name: "Chocolate Brown", hex: "#A67C52" },
      { name: "Storm Cloud", hex: "#868E96" },
      { name: "Midnight Black", hex: "#212529" },
      { name: "Snow White", hex: "#F8F9FA" },
      { name: "Ocean Teal", hex: "#38D9A9" },
    ];

    const BRUSHES = [
      { size: 8, label: "Fine" },
      { size: 20, label: "Medium" },
      { size: 40, label: "Thick" },
      { size: 60, label: "Chunky" },
    ];

    // State
    let currentColor = COLORS[0].hex;
    let currentBrush = BRUSHES[1].size;
    let isDrawing = false;
    let strokes = [];
    let currentStroke = null;

    // Canvas setup
    const canvas = document.getElementById('playroom-canvas');
    const ctx = canvas.getContext('2d');

    // Resize canvas to fit container
    function resizeCanvas() {
      const wrapper = canvas.parentElement;
      const maxWidth = wrapper.clientWidth - 20;
      const maxHeight = wrapper.clientHeight - 20;

      const aspectRatio = 16 / 9;
      let width = maxWidth;
      let height = width / aspectRatio;

      if (height > maxHeight) {
        height = maxHeight;
        width = height * aspectRatio;
      }

      // Only resize if significantly different (prevents blur on minor changes)
      if (Math.abs(canvas.width - width) > 50 || Math.abs(canvas.height - height) > 50) {
        // Save current content
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);

        canvas.width = Math.floor(width);
        canvas.height = Math.floor(height);

        // Restore content
        ctx.putImageData(imageData, 0, 0);
        redraw();
      }
    }

    // Initialize color palette
    function initColorPalette() {
      const palette = document.getElementById('colorPalette');
      COLORS.forEach((color, i) => {
        const btn = document.createElement('button');
        btn.className = 'color-btn' + (i === 0 ? ' active' : '');
        btn.style.backgroundColor = color.hex;
        btn.title = color.name;
        btn.onclick = () => selectColor(color.hex, btn);
        palette.appendChild(btn);
      });
    }

    // Initialize brush panel
    function initBrushPanel() {
      const panel = document.getElementById('brushPanel');
      BRUSHES.forEach((brush, i) => {
        const btn = document.createElement('button');
        btn.className = 'brush-btn' + (i === 1 ? ' active' : '');
        btn.title = brush.label;

        const dot = document.createElement('div');
        dot.className = 'brush-dot';
        dot.style.width = Math.min(brush.size, 30) + 'px';
        dot.style.height = Math.min(brush.size, 30) + 'px';
        btn.appendChild(dot);

        btn.onclick = () => selectBrush(brush.size, btn);
        panel.appendChild(btn);
      });
    }

    function selectColor(hex, btn) {
      currentColor = hex;
      document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      createSplash(btn, hex);
    }

    function selectBrush(size, btn) {
      currentBrush = size;
      document.querySelectorAll('.brush-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
    }

    // Create splash effect
    function createSplash(element, color) {
      const rect = element.getBoundingClientRect();
      const splash = document.createElement('div');
      splash.className = 'splash';
      splash.style.left = rect.left + rect.width/2 - 25 + 'px';
      splash.style.top = rect.top + rect.height/2 - 25 + 'px';
      splash.style.width = '50px';
      splash.style.height = '50px';
      splash.style.backgroundColor = color;
      document.body.appendChild(splash);
      setTimeout(() => splash.remove(), 600);
    }

    // Drawing functions
    function getPos(e) {
      const rect = canvas.getBoundingClientRect();
      const scaleX = canvas.width / rect.width;
      const scaleY = canvas.height / rect.height;

      if (e.touches) {
        return {
          x: (e.touches[0].clientX - rect.left) * scaleX,
          y: (e.touches[0].clientY - rect.top) * scaleY
        };
      }
      return {
        x: (e.clientX - rect.left) * scaleX,
        y: (e.clientY - rect.top) * scaleY
      };
    }

    function startDrawing(e) {
      e.preventDefault();
      isDrawing = true;
      const pos = getPos(e);
      currentStroke = {
        color: currentColor,
        size: currentBrush,
        points: [pos]
      };
    }

    function draw(e) {
      if (!isDrawing || !currentStroke) return;
      e.preventDefault();

      const pos = getPos(e);
      const lastPoint = currentStroke.points[currentStroke.points.length - 1];

      ctx.beginPath();
      ctx.strokeStyle = currentStroke.color;
      ctx.lineWidth = currentStroke.size;
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';
      ctx.moveTo(lastPoint.x, lastPoint.y);
      ctx.lineTo(pos.x, pos.y);
      ctx.stroke();

      currentStroke.points.push(pos);
    }

    function stopDrawing(e) {
      if (isDrawing && currentStroke && currentStroke.points.length > 0) {
        strokes.push(currentStroke);
      }
      isDrawing = false;
      currentStroke = null;
    }

    function redraw() {
      ctx.fillStyle = '#FFFFFF';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      strokes.forEach(stroke => {
        if (stroke.points.length < 2) return;

        ctx.beginPath();
        ctx.strokeStyle = stroke.color;
        ctx.lineWidth = stroke.size;
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';

        ctx.moveTo(stroke.points[0].x, stroke.points[0].y);
        for (let i = 1; i < stroke.points.length; i++) {
          ctx.lineTo(stroke.points[i].x, stroke.points[i].y);
        }
        ctx.stroke();
      });
    }

    // Actions
    function undo() {
      if (strokes.length > 0) {
        strokes.pop();
        redraw();
      }
    }

    function clearCanvas() {
      if (confirm('Clear your painting? This cannot be undone!')) {
        strokes = [];
        redraw();
      }
    }

    function saveCanvas() {
      const link = document.createElement('a');
      const artistName = document.getElementById('artistName').value || 'artwork';
      link.download = `${artistName}-${Date.now()}.png`;
      link.href = canvas.toDataURL('image/png');
      link.click();
    }

    function newCanvas() {
      if (strokes.length > 0 && !confirm('Start a new painting?')) return;
      strokes = [];
      redraw();
    }

    // Help toggle
    let helpVisible = false;
    document.getElementById('helpBtn').onclick = () => {
      helpVisible = !helpVisible;
      document.getElementById('instructions').classList.toggle('visible', helpVisible);
    };

    // Event listeners
    canvas.addEventListener('mousedown', startDrawing);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('mouseleave', stopDrawing);

    canvas.addEventListener('touchstart', startDrawing, { passive: false });
    canvas.addEventListener('touchmove', draw, { passive: false });
    canvas.addEventListener('touchend', stopDrawing);
    canvas.addEventListener('touchcancel', stopDrawing);

    document.getElementById('undoBtn').onclick = undo;
    document.getElementById('clearBtn').onclick = clearCanvas;
    document.getElementById('saveBtn').onclick = saveCanvas;
    document.getElementById('newBtn').onclick = newCanvas;

    window.addEventListener('resize', resizeCanvas);

    // Initialize
    initColorPalette();
    initBrushPanel();
    resizeCanvas();
    redraw();

    // Easter egg: Konami code enables rainbow mode
    let konamiProgress = 0;
    const konamiCode = [38, 38, 40, 40, 37, 39, 37, 39, 66, 65];
    document.addEventListener('keydown', (e) => {
      if (e.keyCode === konamiCode[konamiProgress]) {
        konamiProgress++;
        if (konamiProgress === konamiCode.length) {
          document.body.classList.toggle('rainbow-mode');
          konamiProgress = 0;
        }
      } else {
        konamiProgress = 0;
      }
    });

    console.log('Genesis Playroom loaded! Have fun painting!');
  </script>
</body>
</html>
