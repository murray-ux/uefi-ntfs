<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GENESIS - Control Panel</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: #f5f5f7;
      min-height: 100vh;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       LOGIN - Big, obvious, impossible to miss
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .login {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    }

    .login.hidden { display: none; }

    .login-box {
      background: white;
      border-radius: 24px;
      padding: 48px;
      width: 420px;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    .login-icon {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      border-radius: 20px;
      margin: 0 auto 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
    }

    .login-title {
      font-size: 28px;
      font-weight: 700;
      color: #1a1a2e;
      margin-bottom: 8px;
    }

    .login-subtitle {
      font-size: 16px;
      color: #666;
      margin-bottom: 32px;
    }

    .login-label {
      display: block;
      text-align: left;
      font-size: 14px;
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
    }

    .login-input {
      width: 100%;
      padding: 16px 20px;
      font-size: 16px;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      margin-bottom: 20px;
      transition: border-color 0.2s;
    }

    .login-input:focus {
      outline: none;
      border-color: #667eea;
    }

    .login-btn {
      width: 100%;
      padding: 18px;
      font-size: 18px;
      font-weight: 600;
      color: white;
      background: linear-gradient(135deg, #667eea, #764ba2);
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
    }

    .login-btn:active {
      transform: translateY(0);
    }

    .login-error {
      background: #fee2e2;
      color: #dc2626;
      padding: 14px;
      border-radius: 10px;
      margin-top: 20px;
      font-weight: 500;
      display: none;
    }

    .login-error.show { display: block; }

    .login-hint {
      margin-top: 24px;
      padding-top: 24px;
      border-top: 1px solid #eee;
      color: #999;
      font-size: 13px;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MAIN DASHBOARD - Big cards, obvious everything
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .dashboard {
      display: none;
      min-height: 100vh;
      background: #f5f5f7;
    }

    .dashboard.show { display: block; }

    /* Header */
    .header {
      background: white;
      padding: 16px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .header-logo {
      width: 44px;
      height: 44px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .header-title {
      font-size: 22px;
      font-weight: 700;
      color: #1a1a2e;
    }

    .header-status {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: #dcfce7;
      border-radius: 20px;
      color: #16a34a;
      font-weight: 600;
      font-size: 14px;
    }

    .header-status::before {
      content: '';
      width: 10px;
      height: 10px;
      background: #16a34a;
      border-radius: 50%;
      animation: blink 2s infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .header-user {
      font-size: 15px;
      color: #666;
    }

    .header-user strong {
      color: #1a1a2e;
    }

    .logout-btn {
      padding: 10px 20px;
      background: #fee2e2;
      color: #dc2626;
      border: none;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }

    .logout-btn:hover {
      background: #fecaca;
    }

    /* Content */
    .content {
      padding: 32px;
      max-width: 1400px;
      margin: 0 auto;
    }

    /* Stats Row - Big obvious numbers */
    .stats-row {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-bottom: 32px;
    }

    .stat-card {
      background: white;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .stat-label {
      font-size: 14px;
      color: #666;
      margin-bottom: 8px;
      font-weight: 500;
    }

    .stat-value {
      font-size: 36px;
      font-weight: 700;
      color: #1a1a2e;
    }

    .stat-value span {
      font-size: 16px;
      color: #999;
      font-weight: 500;
    }

    /* Section */
    .section {
      margin-bottom: 32px;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
    }

    .section-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    .section-title {
      font-size: 20px;
      font-weight: 700;
      color: #1a1a2e;
    }

    .section-badge {
      background: #e0e7ff;
      color: #4f46e5;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
    }

    /* Big Facet Buttons */
    .facets {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 16px;
      margin-bottom: 32px;
    }

    .facet {
      background: white;
      border-radius: 16px;
      padding: 28px 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      border: 2px solid transparent;
    }

    .facet:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 30px rgba(0,0,0,0.1);
      border-color: #667eea;
    }

    .facet-icon {
      width: 56px;
      height: 56px;
      margin: 0 auto 16px;
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
    }

    .facet-icon.cmd { background: #dbeafe; }
    .facet-icon.idn { background: #fce7f3; }
    .facet-icon.evd { background: #d1fae5; }
    .facet-icon.exe { background: #fef3c7; }
    .facet-icon.out { background: #e0e7ff; }

    .facet-name {
      font-size: 18px;
      font-weight: 700;
      color: #1a1a2e;
      margin-bottom: 4px;
    }

    .facet-desc {
      font-size: 13px;
      color: #666;
    }

    /* Layer Accordion - Super obvious */
    .layers {
      background: white;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .layer {
      border-bottom: 1px solid #f0f0f0;
    }

    .layer:last-child { border-bottom: none; }

    .layer-header {
      padding: 20px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      transition: background 0.2s;
    }

    .layer-header:hover {
      background: #fafafa;
    }

    .layer-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .layer-num {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: 700;
    }

    .layer-num.l0 { background: #f3e8ff; color: #9333ea; }
    .layer-num.l1 { background: #cffafe; color: #0891b2; }
    .layer-num.l2 { background: #d1fae5; color: #059669; }
    .layer-num.l3 { background: #fef3c7; color: #d97706; }
    .layer-num.l4 { background: #fee2e2; color: #dc2626; }

    .layer-info h3 {
      font-size: 17px;
      font-weight: 600;
      color: #1a1a2e;
      margin-bottom: 2px;
    }

    .layer-info p {
      font-size: 14px;
      color: #666;
    }

    .layer-right {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .layer-count {
      background: #f0f0f0;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      color: #666;
    }

    .layer-arrow {
      font-size: 20px;
      color: #999;
      transition: transform 0.3s;
    }

    .layer.open .layer-arrow {
      transform: rotate(180deg);
    }

    .layer-body {
      display: none;
      padding: 0 24px 24px;
    }

    .layer.open .layer-body {
      display: block;
    }

    /* Room Grid - Big clickable cards */
    .rooms {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
      gap: 12px;
    }

    .room {
      background: #fafafa;
      border: 2px solid #e0e0e0;
      border-radius: 14px;
      padding: 18px 12px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .room:hover {
      background: white;
      border-color: #667eea;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
    }

    .room-status {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #22c55e;
      box-shadow: 0 0 8px rgba(34, 197, 94, 0.5);
    }

    .room-status.warning { background: #f59e0b; box-shadow: 0 0 8px rgba(245, 158, 11, 0.5); }
    .room-status.error { background: #ef4444; box-shadow: 0 0 8px rgba(239, 68, 68, 0.5); }
    .room-status.special { background: #a855f7; box-shadow: 0 0 8px rgba(168, 85, 247, 0.5); }

    .room-icon {
      font-size: 32px;
      margin-bottom: 8px;
    }

    .room-name {
      font-size: 13px;
      font-weight: 600;
      color: #333;
    }

    /* Log Panel */
    .log-panel {
      background: white;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .log-header {
      padding: 16px 24px;
      background: #1a1a2e;
      color: white;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .log-header::before {
      content: 'ğŸ“‹';
      font-size: 18px;
    }

    .log-body {
      padding: 20px 24px;
      height: 200px;
      overflow-y: auto;
      background: #1a1a2e;
      font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
      font-size: 13px;
      line-height: 1.8;
    }

    .log-entry {
      display: flex;
      gap: 12px;
    }

    .log-time {
      color: #666;
    }

    .log-msg {
      color: #4ade80;
    }

    .log-msg.warn { color: #fbbf24; }
    .log-msg.error { color: #f87171; }
    .log-msg.info { color: #60a5fa; }

    /* Help Tooltip */
    .help-btn {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 56px;
      height: 56px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      border: none;
      border-radius: 50%;
      color: white;
      font-size: 24px;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
      transition: transform 0.2s;
    }

    .help-btn:hover {
      transform: scale(1.1);
    }

    /* Dev Button */
    .dev-btn {
      position: fixed;
      bottom: 24px;
      right: 92px;
      width: 56px;
      height: 56px;
      background: #1a1a2e;
      border: none;
      border-radius: 50%;
      color: white;
      font-size: 24px;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      transition: transform 0.2s, background 0.2s;
      display: none;
    }

    .dev-btn:hover {
      transform: scale(1.1);
      background: #2d2d4a;
    }

    .dashboard.show .dev-btn { display: flex; align-items: center; justify-content: center; }

    /* Dev Panel Modal */
    .dev-panel {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.7);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .dev-panel.show { display: flex; }

    .dev-modal {
      background: #1a1a2e;
      border-radius: 20px;
      width: 480px;
      max-height: 80vh;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
    }

    .dev-header {
      padding: 20px 24px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .dev-header h2 {
      color: white;
      font-size: 20px;
      font-weight: 700;
    }

    .dev-close {
      background: rgba(255,255,255,0.2);
      border: none;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      color: white;
      font-size: 18px;
      cursor: pointer;
    }

    .dev-body {
      padding: 20px 24px;
      max-height: 60vh;
      overflow-y: auto;
    }

    .dev-section {
      margin-bottom: 24px;
    }

    .dev-section:last-child { margin-bottom: 0; }

    .dev-section-title {
      color: #8888aa;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
    }

    .dev-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 16px;
      background: #252542;
      border-radius: 12px;
      margin-bottom: 8px;
    }

    .dev-row:last-child { margin-bottom: 0; }

    .dev-row-label {
      color: white;
      font-size: 15px;
      font-weight: 500;
    }

    .dev-row-desc {
      color: #8888aa;
      font-size: 12px;
      margin-top: 2px;
    }

    /* Toggle Switch */
    .dev-toggle {
      width: 50px;
      height: 28px;
      background: #3d3d5c;
      border-radius: 14px;
      position: relative;
      cursor: pointer;
      transition: background 0.2s;
    }

    .dev-toggle.on { background: #22c55e; }

    .dev-toggle::after {
      content: '';
      position: absolute;
      width: 24px;
      height: 24px;
      background: white;
      border-radius: 50%;
      top: 2px;
      left: 2px;
      transition: left 0.2s;
    }

    .dev-toggle.on::after { left: 24px; }

    /* Dev Actions */
    .dev-action {
      width: 100%;
      padding: 14px 16px;
      background: #252542;
      border: none;
      border-radius: 12px;
      color: white;
      font-size: 15px;
      font-weight: 500;
      text-align: left;
      cursor: pointer;
      margin-bottom: 8px;
      transition: background 0.2s;
    }

    .dev-action:hover { background: #333355; }

    .dev-action.danger {
      background: #7f1d1d;
    }

    .dev-action.danger:hover { background: #991b1b; }

    .dev-action-icon {
      margin-right: 10px;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TOAST NOTIFICATIONS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .toast-container {
      position: fixed;
      top: 80px;
      right: 24px;
      z-index: 2000;
      display: flex;
      flex-direction: column;
      gap: 12px;
      pointer-events: none;
    }

    .toast {
      background: white;
      border-radius: 12px;
      padding: 16px 20px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.15);
      display: flex;
      align-items: center;
      gap: 12px;
      min-width: 280px;
      max-width: 400px;
      pointer-events: auto;
      transform: translateX(120%);
      opacity: 0;
      animation: toastIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    }

    .toast.hide {
      animation: toastOut 0.3s ease-in forwards;
    }

    @keyframes toastIn {
      to { transform: translateX(0); opacity: 1; }
    }

    @keyframes toastOut {
      to { transform: translateX(120%); opacity: 0; }
    }

    .toast-icon {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      flex-shrink: 0;
    }

    .toast-icon.success { background: #dcfce7; }
    .toast-icon.error { background: #fee2e2; }
    .toast-icon.warning { background: #fef3c7; }
    .toast-icon.info { background: #dbeafe; }

    .toast-content {
      flex: 1;
    }

    .toast-title {
      font-size: 14px;
      font-weight: 600;
      color: #1a1a2e;
      margin-bottom: 2px;
    }

    .toast-message {
      font-size: 13px;
      color: #666;
    }

    .toast-close {
      background: none;
      border: none;
      color: #999;
      font-size: 18px;
      cursor: pointer;
      padding: 4px;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       ROOM DETAIL MODAL
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .room-modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .room-modal.show {
      display: flex;
      opacity: 1;
    }

    .room-modal-content {
      background: white;
      border-radius: 20px;
      width: 440px;
      max-height: 80vh;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      transform: scale(0.9) translateY(20px);
      transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .room-modal.show .room-modal-content {
      transform: scale(1) translateY(0);
    }

    .room-modal-header {
      padding: 24px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }

    .room-modal-icon {
      font-size: 48px;
      margin-bottom: 12px;
    }

    .room-modal-name {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .room-modal-layer {
      font-size: 14px;
      opacity: 0.8;
    }

    .room-modal-close {
      background: rgba(255,255,255,0.2);
      border: none;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      color: white;
      font-size: 20px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .room-modal-close:hover {
      background: rgba(255,255,255,0.3);
    }

    .room-modal-body {
      padding: 24px;
    }

    .room-stat-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
      margin-bottom: 20px;
    }

    .room-stat {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 16px;
    }

    .room-stat-label {
      font-size: 12px;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 4px;
    }

    .room-stat-value {
      font-size: 20px;
      font-weight: 700;
      color: #1a1a2e;
    }

    .room-stat-value.online { color: #16a34a; }
    .room-stat-value.warning { color: #d97706; }
    .room-stat-value.error { color: #dc2626; }

    .room-actions {
      display: flex;
      gap: 12px;
    }

    .room-action-btn {
      flex: 1;
      padding: 14px;
      border: none;
      border-radius: 12px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .room-action-btn.primary {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
    }

    .room-action-btn.primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .room-action-btn.secondary {
      background: #f0f0f0;
      color: #333;
    }

    .room-action-btn.secondary:hover {
      background: #e5e5e5;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SETTINGS PANEL
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .settings-btn {
      position: fixed;
      bottom: 24px;
      right: 160px;
      width: 56px;
      height: 56px;
      background: #f0f0f0;
      border: none;
      border-radius: 50%;
      color: #666;
      font-size: 24px;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      transition: transform 0.2s, background 0.2s;
      display: none;
    }

    .settings-btn:hover {
      transform: scale(1.1);
      background: #e5e5e5;
    }

    .dashboard.show .settings-btn { display: flex; align-items: center; justify-content: center; }

    .settings-panel {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .settings-panel.show { display: flex; }

    .settings-modal {
      background: white;
      border-radius: 20px;
      width: 480px;
      max-height: 80vh;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    .settings-header {
      padding: 20px 24px;
      background: #f8f9fa;
      border-bottom: 1px solid #e0e0e0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .settings-header h2 {
      font-size: 20px;
      font-weight: 700;
      color: #1a1a2e;
    }

    .settings-close {
      background: none;
      border: none;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      color: #666;
      font-size: 20px;
      cursor: pointer;
    }

    .settings-body {
      padding: 20px 24px;
      max-height: 60vh;
      overflow-y: auto;
    }

    .settings-section {
      margin-bottom: 24px;
    }

    .settings-section:last-child { margin-bottom: 0; }

    .settings-section-title {
      font-size: 12px;
      font-weight: 600;
      color: #999;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
    }

    .settings-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 0;
      border-bottom: 1px solid #f0f0f0;
    }

    .settings-row:last-child { border-bottom: none; }

    .settings-row-label {
      font-size: 15px;
      font-weight: 500;
      color: #333;
    }

    .settings-toggle {
      width: 50px;
      height: 28px;
      background: #e0e0e0;
      border-radius: 14px;
      position: relative;
      cursor: pointer;
      transition: background 0.2s;
    }

    .settings-toggle.on { background: #667eea; }

    .settings-toggle::after {
      content: '';
      position: absolute;
      width: 24px;
      height: 24px;
      background: white;
      border-radius: 50%;
      top: 2px;
      left: 2px;
      transition: left 0.2s;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    .settings-toggle.on::after { left: 24px; }

    /* Theme selector */
    .theme-selector {
      display: flex;
      gap: 12px;
    }

    .theme-option {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      border: 3px solid transparent;
      cursor: pointer;
      transition: all 0.2s;
    }

    .theme-option:hover { transform: scale(1.1); }

    .theme-option.active { border-color: #667eea; }

    .theme-option.light { background: linear-gradient(135deg, #f5f5f7, #e0e0e0); }
    .theme-option.dark { background: linear-gradient(135deg, #1a1a2e, #16213e); }
    .theme-option.system { background: linear-gradient(135deg, #f5f5f7 50%, #1a1a2e 50%); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       FINANCIAL RELIEF TRACKER
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .financial-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 16px;
    }

    .financial-card {
      background: white;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      border-left: 4px solid #667eea;
      transition: all 0.2s;
    }

    .financial-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }

    .financial-card.completed { border-left-color: #22c55e; }
    .financial-card.pending { border-left-color: #f59e0b; }
    .financial-card.not-started { border-left-color: #94a3b8; }

    .financial-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
    }

    .financial-card-type {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #667eea;
    }

    .financial-card-status {
      font-size: 11px;
      font-weight: 600;
      padding: 4px 10px;
      border-radius: 12px;
      text-transform: uppercase;
    }

    .financial-card-status.completed { background: #dcfce7; color: #16a34a; }
    .financial-card-status.pending { background: #fef3c7; color: #d97706; }
    .financial-card-status.not-started { background: #f1f5f9; color: #64748b; }

    .financial-card-title {
      font-size: 16px;
      font-weight: 600;
      color: #1a1a2e;
      margin-bottom: 8px;
    }

    .financial-card-desc {
      font-size: 13px;
      color: #666;
      line-height: 1.5;
      margin-bottom: 12px;
    }

    .financial-card-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 12px;
      border-top: 1px solid #f0f0f0;
    }

    .financial-card-date {
      font-size: 12px;
      color: #999;
    }

    .financial-card-docs {
      font-size: 12px;
      color: #667eea;
      font-weight: 500;
    }

    .financial-summary {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      margin-bottom: 24px;
    }

    .financial-stat {
      background: white;
      border-radius: 12px;
      padding: 16px;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .financial-stat-value {
      font-size: 28px;
      font-weight: 700;
      color: #1a1a2e;
    }

    .financial-stat-value.green { color: #22c55e; }
    .financial-stat-value.amber { color: #f59e0b; }
    .financial-stat-value.gray { color: #94a3b8; }

    .financial-stat-label {
      font-size: 12px;
      color: #666;
      margin-top: 4px;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       LOG FILTERING
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .log-toolbar {
      padding: 12px 24px;
      background: #252542;
      display: flex;
      gap: 8px;
      border-bottom: 1px solid #3d3d5c;
    }

    .log-filter {
      padding: 6px 14px;
      background: #3d3d5c;
      border: none;
      border-radius: 20px;
      color: #aaa;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .log-filter:hover { background: #4d4d6c; color: white; }
    .log-filter.active { background: #667eea; color: white; }

    .log-clear {
      margin-left: auto;
      padding: 6px 14px;
      background: transparent;
      border: 1px solid #666;
      border-radius: 20px;
      color: #888;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .log-clear:hover { border-color: #f87171; color: #f87171; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SMOOTH ANIMATIONS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .stat-card {
      animation: fadeInUp 0.5s ease-out backwards;
    }

    .stat-card:nth-child(1) { animation-delay: 0.1s; }
    .stat-card:nth-child(2) { animation-delay: 0.2s; }
    .stat-card:nth-child(3) { animation-delay: 0.3s; }
    .stat-card:nth-child(4) { animation-delay: 0.4s; }

    .facet {
      animation: fadeInUp 0.5s ease-out backwards;
    }

    .facet:nth-child(1) { animation-delay: 0.15s; }
    .facet:nth-child(2) { animation-delay: 0.2s; }
    .facet:nth-child(3) { animation-delay: 0.25s; }
    .facet:nth-child(4) { animation-delay: 0.3s; }
    .facet:nth-child(5) { animation-delay: 0.35s; }

    .layer-body {
      animation: fadeInUp 0.3s ease-out;
    }

    .room {
      transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .room:active {
      transform: scale(0.95);
    }

    /* Responsive */
    @media (max-width: 1100px) {
      .facets { grid-template-columns: repeat(3, 1fr); }
      .stats-row { grid-template-columns: repeat(2, 1fr); }
    }

    @media (max-width: 768px) {
      .facets { grid-template-columns: repeat(2, 1fr); }
      .stats-row { grid-template-columns: 1fr; }
      .header { padding: 12px 16px; flex-wrap: wrap; gap: 12px; }
      .content { padding: 16px; }
      .rooms { grid-template-columns: repeat(3, 1fr); }

      /* Mobile floating buttons */
      .help-btn, .dev-btn, .settings-btn {
        width: 48px;
        height: 48px;
        font-size: 20px;
      }

      .help-btn { right: 16px; bottom: 16px; }
      .dev-btn { right: 72px; bottom: 16px; }
      .settings-btn { right: 128px; bottom: 16px; }

      /* Mobile modals */
      .dev-modal, .settings-modal, .room-modal-content {
        width: 95%;
        max-width: 400px;
        margin: 16px;
      }

      .room-stat-grid {
        grid-template-columns: 1fr;
      }

      /* Mobile toast */
      .toast-container {
        left: 16px;
        right: 16px;
        top: auto;
        bottom: 80px;
      }

      .toast {
        min-width: auto;
        width: 100%;
      }

      /* Mobile log */
      .log-toolbar {
        flex-wrap: wrap;
        gap: 6px;
      }

      .log-filter {
        padding: 6px 10px;
        font-size: 11px;
      }
    }

    @media (max-width: 480px) {
      .facets { grid-template-columns: 1fr; }
      .rooms { grid-template-columns: repeat(2, 1fr); }

      .login-box {
        width: 95%;
        padding: 32px 24px;
        margin: 16px;
      }

      .header-title { font-size: 18px; }
      .header-status { display: none; }

      .stat-value { font-size: 28px; }

      .room-actions {
        flex-direction: column;
      }
    }

    /* Reduced motion preference */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
  </style>
</head>
<body>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       LOGIN - Can't possibly mess this up
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="login" id="login">
    <div class="login-box">
      <div class="login-icon">ğŸ”</div>
      <h1 class="login-title">Welcome to Genesis</h1>
      <p class="login-subtitle">Enter your credentials to continue</p>

      <label class="login-label">Owner ID</label>
      <input type="text" class="login-input" id="uid" placeholder="Enter your Owner ID" autocomplete="off">

      <label class="login-label">Passphrase</label>
      <input type="password" class="login-input" id="pwd" placeholder="Enter your passphrase">

      <button class="login-btn" id="loginBtn">Sign In</button>

      <div class="login-error" id="loginErr">
        âš ï¸ Incorrect Owner ID or Passphrase. Please try again.
      </div>

      <div class="login-hint">
        ğŸ”‘ YubiKey users: Touch your key when prompted
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       DASHBOARD - Everything big and obvious
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="dashboard" id="dashboard">
    <header class="header">
      <div class="header-left">
        <div class="header-logo">â¬¡</div>
        <h1 class="header-title">Genesis Control Panel</h1>
        <div class="header-status">System Online</div>
      </div>
      <div class="header-right">
        <span class="header-user">Signed in as <strong id="userName">murray-ux</strong></span>
        <button class="logout-btn" id="logoutBtn">Sign Out</button>
      </div>
    </header>

    <main class="content">

      <!-- Stats - Big obvious numbers -->
      <div class="stats-row">
        <div class="stat-card">
          <div class="stat-label">â±ï¸ System Uptime</div>
          <div class="stat-value"><span id="uptime">0</span> <span>seconds</span></div>
        </div>
        <div class="stat-card">
          <div class="stat-label">ğŸ  Active Rooms</div>
          <div class="stat-value">41 <span>online</span></div>
        </div>
        <div class="stat-card">
          <div class="stat-label">ğŸ“¨ Messages Sent</div>
          <div class="stat-value" id="messages">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">âœ… Policy Checks</div>
          <div class="stat-value" id="checks">0</div>
        </div>
      </div>

      <!-- Pentagon Section -->
      <section class="section">
        <div class="section-header">
          <div class="section-icon">â¬¡</div>
          <h2 class="section-title">Pentagon</h2>
          <span class="section-badge">5 Main Functions</span>
        </div>

        <div class="facets">
          <div class="facet" onclick="showFacet('CMD')">
            <div class="facet-icon cmd">ğŸ’»</div>
            <div class="facet-name">CMD</div>
            <div class="facet-desc">Run Commands</div>
          </div>
          <div class="facet" onclick="showFacet('IDN')">
            <div class="facet-icon idn">ğŸ”</div>
            <div class="facet-name">IDN</div>
            <div class="facet-desc">Identity & Login</div>
          </div>
          <div class="facet" onclick="showFacet('EVD')">
            <div class="facet-icon evd">ğŸ“</div>
            <div class="facet-name">EVD</div>
            <div class="facet-desc">Evidence Storage</div>
          </div>
          <div class="facet" onclick="showFacet('EXE')">
            <div class="facet-icon exe">âš¡</div>
            <div class="facet-name">EXE</div>
            <div class="facet-desc">Run Workflows</div>
          </div>
          <div class="facet" onclick="showFacet('OUT')">
            <div class="facet-icon out">ğŸ“¤</div>
            <div class="facet-name">OUT</div>
            <div class="facet-desc">Generate Reports</div>
          </div>
        </div>
      </section>

      <!-- Layers Section -->
      <section class="section">
        <div class="section-header">
          <div class="section-icon">ğŸ—ï¸</div>
          <h2 class="section-title">System Layers</h2>
          <span class="section-badge">41 Rooms Total</span>
        </div>

        <div class="layers">
          <!-- Layer 0 -->
          <div class="layer" data-layer="0">
            <div class="layer-header" onclick="toggleLayer(this)">
              <div class="layer-left">
                <div class="layer-num l0">L0</div>
                <div class="layer-info">
                  <h3>Kernel</h3>
                  <p>Security, Encryption, Time Stamps</p>
                </div>
              </div>
              <div class="layer-right">
                <span class="layer-count">7 rooms</span>
                <span class="layer-arrow">â–¼</span>
              </div>
            </div>
            <div class="layer-body">
              <div class="rooms">
                <div class="room" onclick="openRoom('Thermostat')"><div class="room-status"></div><div class="room-icon">ğŸŒ¡ï¸</div><div class="room-name">Thermostat</div></div>
                <div class="room" onclick="openRoom('Chip')"><div class="room-status"></div><div class="room-icon">ğŸ”²</div><div class="room-name">Chip</div></div>
                <div class="room" onclick="openRoom('Battery')"><div class="room-status"></div><div class="room-icon">ğŸ”‹</div><div class="room-name">Battery</div></div>
                <div class="room" onclick="openRoom('Clock')"><div class="room-status"></div><div class="room-icon">ğŸ•</div><div class="room-name">Clock</div></div>
                <div class="room" onclick="openRoom('Compass')"><div class="room-status"></div><div class="room-icon">ğŸ§­</div><div class="room-name">Compass</div></div>
                <div class="room" onclick="openRoom('Fuse')"><div class="room-status"></div><div class="room-icon">âš¡</div><div class="room-name">Fuse</div></div>
                <div class="room" onclick="openRoom('Spark')"><div class="room-status"></div><div class="room-icon">âœ¨</div><div class="room-name">Spark</div></div>
              </div>
            </div>
          </div>

          <!-- Layer 1 -->
          <div class="layer" data-layer="1">
            <div class="layer-header" onclick="toggleLayer(this)">
              <div class="layer-left">
                <div class="layer-num l1">L1</div>
                <div class="layer-info">
                  <h3>Conduit</h3>
                  <p>Message Passing & Communication</p>
                </div>
              </div>
              <div class="layer-right">
                <span class="layer-count">7 rooms</span>
                <span class="layer-arrow">â–¼</span>
              </div>
            </div>
            <div class="layer-body">
              <div class="rooms">
                <div class="room" onclick="openRoom('Flares')"><div class="room-status"></div><div class="room-icon">ğŸ”¥</div><div class="room-name">Flares</div></div>
                <div class="room" onclick="openRoom('Locks')"><div class="room-status"></div><div class="room-icon">ğŸ”’</div><div class="room-name">Locks</div></div>
                <div class="room" onclick="openRoom('Doors')"><div class="room-status"></div><div class="room-icon">ğŸšª</div><div class="room-name">Doors</div></div>
                <div class="room" onclick="openRoom('Horn')"><div class="room-status"></div><div class="room-icon">ğŸ“¢</div><div class="room-name">Horn</div></div>
                <div class="room" onclick="openRoom('Mirrors')"><div class="room-status"></div><div class="room-icon">ğŸª</div><div class="room-name">Mirrors</div></div>
                <div class="room" onclick="openRoom('Antenna')"><div class="room-status"></div><div class="room-icon">ğŸ“¡</div><div class="room-name">Antenna</div></div>
                <div class="room" onclick="openRoom('Relay')"><div class="room-status"></div><div class="room-icon">ğŸ”„</div><div class="room-name">Relay</div></div>
              </div>
            </div>
          </div>

          <!-- Layer 2 -->
          <div class="layer" data-layer="2">
            <div class="layer-header" onclick="toggleLayer(this)">
              <div class="layer-left">
                <div class="layer-num l2">L2</div>
                <div class="layer-info">
                  <h3>Reservoir</h3>
                  <p>Data Storage & Caching</p>
                </div>
              </div>
              <div class="layer-right">
                <span class="layer-count">8 rooms</span>
                <span class="layer-arrow">â–¼</span>
              </div>
            </div>
            <div class="layer-body">
              <div class="rooms">
                <div class="room" onclick="openRoom('Trunk')"><div class="room-status"></div><div class="room-icon">ğŸ§³</div><div class="room-name">Trunk</div></div>
                <div class="room" onclick="openRoom('Spares')"><div class="room-status"></div><div class="room-icon">ğŸ”§</div><div class="room-name">Spares</div></div>
                <div class="room" onclick="openRoom('Coolant')"><div class="room-status"></div><div class="room-icon">â„ï¸</div><div class="room-name">Coolant</div></div>
                <div class="room" onclick="openRoom('Wash')"><div class="room-status"></div><div class="room-icon">ğŸ’§</div><div class="room-name">Wash</div></div>
                <div class="room" onclick="openRoom('Tank')"><div class="room-status"></div><div class="room-icon">â›½</div><div class="room-name">Tank</div></div>
                <div class="room" onclick="openRoom('Filter')"><div class="room-status"></div><div class="room-icon">ğŸ§¹</div><div class="room-name">Filter</div></div>
                <div class="room" onclick="openRoom('Jack')"><div class="room-status"></div><div class="room-icon">ğŸ”©</div><div class="room-name">Jack</div></div>
                <div class="room" onclick="openRoom('Glove')"><div class="room-status"></div><div class="room-icon">ğŸ§¤</div><div class="room-name">Glove</div></div>
              </div>
            </div>
          </div>

          <!-- Layer 3 -->
          <div class="layer" data-layer="3">
            <div class="layer-header" onclick="toggleLayer(this)">
              <div class="layer-left">
                <div class="layer-num l3">L3</div>
                <div class="layer-info">
                  <h3>Valve</h3>
                  <p>Policy Control & Rate Limiting</p>
                </div>
              </div>
              <div class="layer-right">
                <span class="layer-count">9 rooms</span>
                <span class="layer-arrow">â–¼</span>
              </div>
            </div>
            <div class="layer-body">
              <div class="rooms">
                <div class="room" onclick="openRoom('Brakes')"><div class="room-status"></div><div class="room-icon">ğŸ›‘</div><div class="room-name">Brakes</div></div>
                <div class="room" onclick="openRoom('Tint')"><div class="room-status"></div><div class="room-icon">ğŸ•¶ï¸</div><div class="room-name">Tint</div></div>
                <div class="room" onclick="openRoom('Wipers')"><div class="room-status"></div><div class="room-icon">ğŸŒ§ï¸</div><div class="room-name">Wipers</div></div>
                <div class="room" onclick="openRoom('Fuel')"><div class="room-status"></div><div class="room-icon">â›½</div><div class="room-name">Fuel</div></div>
                <div class="room" onclick="openRoom('Clutch')"><div class="room-status"></div><div class="room-icon">âš™ï¸</div><div class="room-name">Clutch</div></div>
                <div class="room" onclick="openRoom('Gears')"><div class="room-status"></div><div class="room-icon">âš™ï¸</div><div class="room-name">Gears</div></div>
                <div class="room" onclick="openRoom('Pedals')"><div class="room-status"></div><div class="room-icon">ğŸ‘Ÿ</div><div class="room-name">Pedals</div></div>
                <div class="room" onclick="openRoom('Gauges')"><div class="room-status"></div><div class="room-icon">ğŸ“Š</div><div class="room-name">Gauges</div></div>
                <div class="room" onclick="openRoom('Seatbelts')"><div class="room-status"></div><div class="room-icon">ğŸ”²</div><div class="room-name">Seatbelts</div></div>
              </div>
            </div>
          </div>

          <!-- Layer 4 -->
          <div class="layer" data-layer="4">
            <div class="layer-header" onclick="toggleLayer(this)">
              <div class="layer-left">
                <div class="layer-num l4">L4</div>
                <div class="layer-info">
                  <h3>Manifold</h3>
                  <p>Workflow Orchestration & Pipelines</p>
                </div>
              </div>
              <div class="layer-right">
                <span class="layer-count">10 rooms</span>
                <span class="layer-arrow">â–¼</span>
              </div>
            </div>
            <div class="layer-body">
              <div class="rooms">
                <div class="room" onclick="openRoom('Engine')"><div class="room-status"></div><div class="room-icon">ğŸš—</div><div class="room-name">Engine</div></div>
                <div class="room" onclick="openRoom('Wings')"><div class="room-status"></div><div class="room-icon">ğŸ¦…</div><div class="room-name">Wings</div></div>
                <div class="room" onclick="openRoom('Mods')"><div class="room-status"></div><div class="room-icon">ğŸ”Œ</div><div class="room-name">Mods</div></div>
                <div class="room" onclick="openRoom('Exhaust')"><div class="room-status"></div><div class="room-icon">ğŸ’¨</div><div class="room-name">Exhaust</div></div>
                <div class="room" onclick="openRoom('Turbo')"><div class="room-status"></div><div class="room-icon">ğŸŒ€</div><div class="room-name">Turbo</div></div>
                <div class="room" onclick="openRoom('Chassis')"><div class="room-status"></div><div class="room-icon">ğŸ› ï¸</div><div class="room-name">Chassis</div></div>
                <div class="room" onclick="openRoom('Bumper')"><div class="room-status"></div><div class="room-icon">ğŸš™</div><div class="room-name">Bumper</div></div>
                <div class="room" onclick="openRoom('Spoiler')"><div class="room-status"></div><div class="room-icon">ğŸï¸</div><div class="room-name">Spoiler</div></div>
                <div class="room" onclick="openRoom('Wheels')"><div class="room-status"></div><div class="room-icon">âšª</div><div class="room-name">Wheels</div></div>
                <div class="room" onclick="openRoom('Playroom')"><div class="room-status special"></div><div class="room-icon">ğŸ¨</div><div class="room-name">Playroom</div></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Financial Relief Tracker - Case 6183-2025 -->
      <section class="section" id="financialSection">
        <div class="section-header">
          <div class="section-icon">ğŸ’°</div>
          <h2 class="section-title">Financial Relief Tracker</h2>
          <span class="section-badge">Case 6183-2025</span>
        </div>

        <div class="financial-summary">
          <div class="financial-stat">
            <div class="financial-stat-value" id="finTotal">4</div>
            <div class="financial-stat-label">Total Options</div>
          </div>
          <div class="financial-stat">
            <div class="financial-stat-value green" id="finCompleted">1</div>
            <div class="financial-stat-label">Completed</div>
          </div>
          <div class="financial-stat">
            <div class="financial-stat-value amber" id="finPending">1</div>
            <div class="financial-stat-label">Pending</div>
          </div>
          <div class="financial-stat">
            <div class="financial-stat-value gray" id="finNotStarted">2</div>
            <div class="financial-stat-label">Not Started</div>
          </div>
        </div>

        <div class="financial-grid" id="financialGrid">
          <!-- Card 1: Form 13 -->
          <div class="financial-card completed">
            <div class="financial-card-header">
              <span class="financial-card-type">Court Disclosure</span>
              <span class="financial-card-status completed">Completed</span>
            </div>
            <div class="financial-card-title">Form 13 Financial Statement</div>
            <div class="financial-card-desc">Full financial position disclosed to Court - income, assets, liabilities, superannuation.</div>
            <div class="financial-card-meta">
              <span class="financial-card-date">2025-11-10</span>
              <span class="financial-card-docs">1 document</span>
            </div>
          </div>

          <!-- Card 2: Solicitor Records -->
          <div class="financial-card pending">
            <div class="financial-card-header">
              <span class="financial-card-type">Solicitor Records</span>
              <span class="financial-card-status pending">Pending</span>
            </div>
            <div class="financial-card-title">Paterson & Dowding Request</div>
            <div class="financial-card-desc">Formal request for complete client file and trust account records from former solicitors.</div>
            <div class="financial-card-meta">
              <span class="financial-card-date">2026-02-10</span>
              <span class="financial-card-docs">1 document</span>
            </div>
          </div>

          <!-- Card 3: Legal Aid -->
          <div class="financial-card not-started">
            <div class="financial-card-header">
              <span class="financial-card-type">Legal Aid</span>
              <span class="financial-card-status not-started">Not Started</span>
            </div>
            <div class="financial-card-title">Legal Aid Application</div>
            <div class="financial-card-desc">Application for Legal Aid assistance - demonstrates exploration of all available financial relief options.</div>
            <div class="financial-card-meta">
              <span class="financial-card-date">-</span>
              <span class="financial-card-docs">0 documents</span>
            </div>
          </div>

          <!-- Card 4: Payment Arrangement -->
          <div class="financial-card not-started">
            <div class="financial-card-header">
              <span class="financial-card-type">Payment Arrangement</span>
              <span class="financial-card-status not-started">Not Started</span>
            </div>
            <div class="financial-card-title">Court Fee Hardship Application</div>
            <div class="financial-card-desc">Payment arrangement or hardship application - good faith efforts to meet obligations despite constraints.</div>
            <div class="financial-card-meta">
              <span class="financial-card-date">-</span>
              <span class="financial-card-docs">0 documents</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Activity Log -->
      <section class="section">
        <div class="section-header">
          <div class="section-icon">ğŸ“‹</div>
          <h2 class="section-title">Activity Log</h2>
          <span class="section-badge">Live Updates</span>
        </div>

        <div class="log-panel">
          <div class="log-header">System Events</div>
          <div class="log-toolbar">
            <button class="log-filter active" data-filter="all" onclick="filterLog('all')">All</button>
            <button class="log-filter" data-filter="info" onclick="filterLog('info')">Info</button>
            <button class="log-filter" data-filter="warn" onclick="filterLog('warn')">Warnings</button>
            <button class="log-filter" data-filter="error" onclick="filterLog('error')">Errors</button>
            <button class="log-clear" onclick="clearLog()">Clear</button>
          </div>
          <div class="log-body" id="logBody"></div>
        </div>
      </section>

    </main>

    <button class="settings-btn" onclick="toggleSettings()" title="Settings">âš™ï¸</button>
    <button class="dev-btn" onclick="toggleDevPanel()" title="Developer Settings">ğŸ”§</button>
    <button class="help-btn" onclick="showHelp()" title="Need help?">?</button>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Room Detail Modal -->
  <div class="room-modal" id="roomModal">
    <div class="room-modal-content">
      <div class="room-modal-header">
        <div>
          <div class="room-modal-icon" id="roomModalIcon">ğŸŒ¡ï¸</div>
          <div class="room-modal-name" id="roomModalName">Thermostat</div>
          <div class="room-modal-layer" id="roomModalLayer">Layer 0 - Kernel</div>
        </div>
        <button class="room-modal-close" onclick="closeRoomModal()">Ã—</button>
      </div>
      <div class="room-modal-body">
        <div class="room-stat-grid">
          <div class="room-stat">
            <div class="room-stat-label">Status</div>
            <div class="room-stat-value online" id="roomModalStatus">Online</div>
          </div>
          <div class="room-stat">
            <div class="room-stat-label">Uptime</div>
            <div class="room-stat-value" id="roomModalUptime">99.9%</div>
          </div>
          <div class="room-stat">
            <div class="room-stat-label">Last Check</div>
            <div class="room-stat-value" id="roomModalLastCheck">Just now</div>
          </div>
          <div class="room-stat">
            <div class="room-stat-label">Messages</div>
            <div class="room-stat-value" id="roomModalMessages">1,247</div>
          </div>
        </div>
        <div class="room-actions">
          <button class="room-action-btn secondary" onclick="copyRoomLink()">Copy Link</button>
          <button class="room-action-btn primary" onclick="refreshRoom()">Refresh Status</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Settings Panel -->
  <div class="settings-panel" id="settingsPanel">
    <div class="settings-modal">
      <div class="settings-header">
        <h2>Settings</h2>
        <button class="settings-close" onclick="toggleSettings()">Ã—</button>
      </div>
      <div class="settings-body">

        <div class="settings-section">
          <div class="settings-section-title">Appearance</div>
          <div class="settings-row">
            <span class="settings-row-label">Theme</span>
            <div class="theme-selector">
              <div class="theme-option light active" data-theme="light" onclick="setTheme('light')" title="Light"></div>
              <div class="theme-option dark" data-theme="dark" onclick="setTheme('dark')" title="Dark"></div>
              <div class="theme-option system" data-theme="system" onclick="setTheme('system')" title="System"></div>
            </div>
          </div>
          <div class="settings-row">
            <span class="settings-row-label">Compact Mode</span>
            <div class="settings-toggle" data-setting="compactMode" onclick="toggleAppSetting(this)"></div>
          </div>
        </div>

        <div class="settings-section">
          <div class="settings-section-title">Notifications</div>
          <div class="settings-row">
            <span class="settings-row-label">Show Toast Notifications</span>
            <div class="settings-toggle on" data-setting="showToasts" onclick="toggleAppSetting(this)"></div>
          </div>
          <div class="settings-row">
            <span class="settings-row-label">Sound Alerts</span>
            <div class="settings-toggle" data-setting="soundAlerts" onclick="toggleAppSetting(this)"></div>
          </div>
          <div class="settings-row">
            <span class="settings-row-label">Desktop Notifications</span>
            <div class="settings-toggle" data-setting="desktopNotify" onclick="toggleAppSetting(this)"></div>
          </div>
        </div>

        <div class="settings-section">
          <div class="settings-section-title">Dashboard</div>
          <div class="settings-row">
            <span class="settings-row-label">Auto-refresh Stats</span>
            <div class="settings-toggle on" data-setting="autoRefresh" onclick="toggleAppSetting(this)"></div>
          </div>
          <div class="settings-row">
            <span class="settings-row-label">Show Layer Previews</span>
            <div class="settings-toggle on" data-setting="layerPreviews" onclick="toggleAppSetting(this)"></div>
          </div>
          <div class="settings-row">
            <span class="settings-row-label">Animate Transitions</span>
            <div class="settings-toggle on" data-setting="animations" onclick="toggleAppSetting(this)"></div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       DEVELOPER PANEL - iOS Developer Settings patterns
       prefs:root=DEVELOPER_SETTINGS
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="dev-panel" id="devPanel">
    <div class="dev-modal">
      <div class="dev-header">
        <h2>ğŸ”§ Developer Settings</h2>
        <button class="dev-close" onclick="toggleDevPanel()">Ã—</button>
      </div>
      <div class="dev-body">

        <!-- Trusted Devices -->
        <div class="dev-section">
          <div class="dev-section-title">Trusted Devices</div>
          <button class="dev-action" onclick="devAction('clearTrusted')">
            <span class="dev-action-icon">ğŸ”’</span>Clear Trusted Computers
          </button>
          <div class="dev-row">
            <div>
              <div class="dev-row-label">Require Trust on Connect</div>
              <div class="dev-row-desc">Prompt for device authorization</div>
            </div>
            <div class="dev-toggle on" data-setting="requireTrust" onclick="toggleSetting(this)"></div>
          </div>
        </div>

        <!-- Logging -->
        <div class="dev-section">
          <div class="dev-section-title">Logging</div>
          <div class="dev-row">
            <div>
              <div class="dev-row-label">Enable Log Capture</div>
              <div class="dev-row-desc">Record system events to file</div>
            </div>
            <div class="dev-toggle on" data-setting="logCapture" onclick="toggleSetting(this)"></div>
          </div>
          <div class="dev-row">
            <div>
              <div class="dev-row-label">Verbose Mode</div>
              <div class="dev-row-desc">Include debug-level messages</div>
            </div>
            <div class="dev-toggle" data-setting="verboseLog" onclick="toggleSetting(this)"></div>
          </div>
          <div class="dev-row">
            <div>
              <div class="dev-row-label">Profile Logging</div>
              <div class="dev-row-desc">Performance profiling enabled</div>
            </div>
            <div class="dev-toggle" data-setting="profileLog" onclick="toggleSetting(this)"></div>
          </div>
        </div>

        <!-- UI Automation -->
        <div class="dev-section">
          <div class="dev-section-title">UI Automation</div>
          <div class="dev-row">
            <div>
              <div class="dev-row-label">Enable UI Automation</div>
              <div class="dev-row-desc">Allow automated testing</div>
            </div>
            <div class="dev-toggle" data-setting="uiAutomation" onclick="toggleSetting(this)"></div>
          </div>
          <div class="dev-row">
            <div>
              <div class="dev-row-label">Show Touch Indicators</div>
              <div class="dev-row-desc">Visual feedback for interactions</div>
            </div>
            <div class="dev-toggle" data-setting="touchIndicators" onclick="toggleSetting(this)"></div>
          </div>
        </div>

        <!-- Networking -->
        <div class="dev-section">
          <div class="dev-section-title">Networking</div>
          <div class="dev-row">
            <div>
              <div class="dev-row-label">Rate Limiting</div>
              <div class="dev-row-desc">Throttle API requests</div>
            </div>
            <div class="dev-toggle on" data-setting="rateLimiting" onclick="toggleSetting(this)"></div>
          </div>
          <div class="dev-row">
            <div>
              <div class="dev-row-label">HTTP Logging</div>
              <div class="dev-row-desc">Log all HTTP requests</div>
            </div>
            <div class="dev-toggle" data-setting="httpLogging" onclick="toggleSetting(this)"></div>
          </div>
          <div class="dev-row">
            <div>
              <div class="dev-row-label">Network Conditioner</div>
              <div class="dev-row-desc">Simulate slow connections</div>
            </div>
            <div class="dev-toggle" data-setting="networkConditioner" onclick="toggleSetting(this)"></div>
          </div>
        </div>

        <!-- API Testing -->
        <div class="dev-section">
          <div class="dev-section-title">API Testing</div>
          <div class="dev-row">
            <div>
              <div class="dev-row-label">Mock API Responses</div>
              <div class="dev-row-desc">Use test fixtures</div>
            </div>
            <div class="dev-toggle" data-setting="mockApi" onclick="toggleSetting(this)"></div>
          </div>
          <div class="dev-row">
            <div>
              <div class="dev-row-label">Bypass Authentication</div>
              <div class="dev-row-desc">Skip token validation</div>
            </div>
            <div class="dev-toggle" data-setting="bypassAuth" onclick="toggleSetting(this)"></div>
          </div>
        </div>

        <!-- Reset Operations -->
        <div class="dev-section">
          <div class="dev-section-title">Reset Operations</div>
          <button class="dev-action" onclick="devAction('resetLocalData')">
            <span class="dev-action-icon">ğŸ—‘ï¸</span>Reset Local Data
          </button>
          <button class="dev-action" onclick="devAction('resetSettings')">
            <span class="dev-action-icon">âš™ï¸</span>Reset All Settings
          </button>
          <button class="dev-action danger" onclick="devAction('factoryReset')">
            <span class="dev-action-icon">âš ï¸</span>Factory Reset
          </button>
        </div>

      </div>
    </div>
  </div>

  <script>
    // Credentials
    const VALID_UID = 'murray-ux';
    const VALID_PWD = 'genesis';

    // Elements
    const loginEl = document.getElementById('login');
    const dashboardEl = document.getElementById('dashboard');
    const uidEl = document.getElementById('uid');
    const pwdEl = document.getElementById('pwd');
    const loginBtn = document.getElementById('loginBtn');
    const loginErr = document.getElementById('loginErr');
    const logBody = document.getElementById('logBody');

    // Stats
    let uptime = 0;
    let messages = 0;
    let checks = 0;

    // Login
    loginBtn.onclick = function() {
      if (uidEl.value === VALID_UID && pwdEl.value === VALID_PWD) {
        loginEl.classList.add('hidden');
        dashboardEl.classList.add('show');
        document.getElementById('userName').textContent = uidEl.value;
        log('info', 'Successfully signed in as ' + uidEl.value);
        log('info', 'Genesis Control Panel loaded');
        log('info', 'All 41 rooms are online');
        startStats();
      } else {
        loginErr.classList.add('show');
        log('error', 'Sign in failed - incorrect credentials');
        setTimeout(function() {
          loginErr.classList.remove('show');
        }, 3000);
      }
    };

    // Enter key support
    pwdEl.onkeypress = function(e) {
      if (e.key === 'Enter') loginBtn.click();
    };
    uidEl.onkeypress = function(e) {
      if (e.key === 'Enter') pwdEl.focus();
    };

    // Logout
    document.getElementById('logoutBtn').onclick = function() {
      dashboardEl.classList.remove('show');
      loginEl.classList.remove('hidden');
      uidEl.value = '';
      pwdEl.value = '';
      log('warn', 'Signed out');
    };

    // Toggle layer
    function toggleLayer(header) {
      header.parentElement.classList.toggle('open');
    }

    // Open room
    function openRoom(name) {
      log('info', 'Opened room: ' + name);
      alert('Room: ' + name + '\n\nStatus: Online\nLast check: Just now');
    }

    // Show facet
    function showFacet(name) {
      var descs = {
        CMD: 'Command Execution - Run system commands securely',
        IDN: 'Identity & Authentication - Manage logins and access',
        EVD: 'Evidence Storage - Store and retrieve evidence files',
        EXE: 'Workflow Execution - Run automated workflows',
        OUT: 'Output Generation - Create reports and exports'
      };
      log('info', 'Accessed ' + name + ' facet');
      alert(name + ' Facet\n\n' + descs[name] + '\n\nStatus: Active');
    }

    // Show help
    function showHelp() {
      alert(
        'Genesis Control Panel - Quick Guide\n\n' +
        'ğŸ”¹ PENTAGON: Click any of the 5 main functions to access them\n\n' +
        'ğŸ”¹ LAYERS: Click a layer header to expand and see its rooms\n\n' +
        'ğŸ”¹ ROOMS: Click any room to check its status\n\n' +
        'ğŸ”¹ LOG: Activity is recorded at the bottom of the page\n\n' +
        'Need more help? Contact your system administrator.'
      );
    }

    // Log function
    function log(type, message) {
      var time = new Date().toLocaleTimeString('en-AU', { hour12: false });
      var entry = document.createElement('div');
      entry.className = 'log-entry';
      entry.innerHTML = '<span class="log-time">[' + time + ']</span> <span class="log-msg ' + type + '">' + message + '</span>';
      logBody.appendChild(entry);
      logBody.scrollTop = logBody.scrollHeight;
    }

    // Start stats counter
    function startStats() {
      setInterval(function() {
        uptime++;
        messages += Math.floor(Math.random() * 3);
        checks += Math.floor(Math.random() * 2);

        document.getElementById('uptime').textContent = uptime;
        document.getElementById('messages').textContent = messages;
        document.getElementById('checks').textContent = checks;

        // Random activity
        if (Math.random() < 0.1) {
          var rooms = ['Clock', 'Battery', 'Engine', 'Fuel', 'Relay', 'Filter'];
          var room = rooms[Math.floor(Math.random() * rooms.length)];
          log('info', room + ' check complete - OK');
        }
      }, 1000);
    }

    // Initial log
    log('info', 'Control Panel ready');
    log('info', 'Please sign in to continue');

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // DEEP LINKING - iOS prefs: style URL navigation
    // Patterns:
    //   #layer=0           â†’ Open Layer 0 (Kernel)
    //   #room=Thermostat   â†’ Open specific room
    //   #facet=CMD         â†’ Open facet
    //   #layer=2&room=Tank â†’ Combined navigation
    //   #settings          â†’ Show settings
    //   #help              â†’ Show help
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    const DeepLink = {
      // Parse hash into params object
      parse: function(hash) {
        if (!hash || hash === '#') return {};
        const params = {};
        hash.replace(/^#/, '').split('&').forEach(function(part) {
          const [key, value] = part.split('=');
          if (key) params[decodeURIComponent(key)] = value ? decodeURIComponent(value) : true;
        });
        return params;
      },

      // Generate hash from params
      generate: function(params) {
        return '#' + Object.entries(params)
          .map(function([k, v]) {
            return v === true ? encodeURIComponent(k) : encodeURIComponent(k) + '=' + encodeURIComponent(v);
          })
          .join('&');
      },

      // Navigate to deep link
      navigate: function(params) {
        // Must be logged in
        if (!dashboardEl.classList.contains('show')) {
          log('warn', 'Deep link requires authentication');
          DeepLink.pending = params;
          return;
        }

        // Handle layer
        if (params.layer !== undefined) {
          const layerEl = document.querySelector('[data-layer="' + params.layer + '"]');
          if (layerEl) {
            layerEl.classList.add('open');
            layerEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
            log('info', 'Deep link: Opened Layer ' + params.layer);
          }
        }

        // Handle room
        if (params.room) {
          const roomEl = document.querySelector('.room-name');
          // Find the room by name
          document.querySelectorAll('.room').forEach(function(el) {
            if (el.querySelector('.room-name').textContent === params.room) {
              // Expand parent layer
              const layerBody = el.closest('.layer-body');
              if (layerBody) {
                layerBody.parentElement.classList.add('open');
              }
              // Highlight room
              el.style.outline = '3px solid #667eea';
              el.scrollIntoView({ behavior: 'smooth', block: 'center' });
              setTimeout(function() { el.style.outline = ''; }, 2000);
              log('info', 'Deep link: Navigated to ' + params.room);
            }
          });
        }

        // Handle facet
        if (params.facet) {
          showFacet(params.facet);
          log('info', 'Deep link: Opened ' + params.facet + ' facet');
        }

        // Handle help
        if (params.help) {
          showHelp();
        }
      },

      // Get shareable link for current view
      getLink: function(params) {
        return window.location.origin + window.location.pathname + DeepLink.generate(params);
      },

      // Pending deep link (before login)
      pending: null
    };

    // Handle initial deep link
    if (window.location.hash) {
      DeepLink.navigate(DeepLink.parse(window.location.hash));
    }

    // Handle hash changes
    window.addEventListener('hashchange', function() {
      DeepLink.navigate(DeepLink.parse(window.location.hash));
    });

    // Execute pending deep link after login
    const originalLoginClick = loginBtn.onclick;
    loginBtn.onclick = function() {
      originalLoginClick.call(this);
      if (dashboardEl.classList.contains('show') && DeepLink.pending) {
        setTimeout(function() {
          DeepLink.navigate(DeepLink.pending);
          DeepLink.pending = null;
        }, 100);
      }
    };

    // Add copy link button to rooms
    function openRoom(name) {
      const link = DeepLink.getLink({ room: name });
      log('info', 'Opened room: ' + name);
      const confirmed = confirm(
        'Room: ' + name + '\n\n' +
        'Status: Online\n' +
        'Last check: Just now\n\n' +
        'Direct link:\n' + link + '\n\n' +
        'Copy link to clipboard?'
      );
      if (confirmed) {
        navigator.clipboard.writeText(link).then(function() {
          log('info', 'Copied deep link for ' + name);
        });
      }
      // Update URL without triggering navigation
      history.replaceState(null, '', DeepLink.generate({ room: name }));
    }

    // Add copy link to facets
    function showFacet(name) {
      const descs = {
        CMD: 'Command Execution - Run system commands securely',
        IDN: 'Identity & Authentication - Manage logins and access',
        EVD: 'Evidence Storage - Store and retrieve evidence files',
        EXE: 'Workflow Execution - Run automated workflows',
        OUT: 'Output Generation - Create reports and exports'
      };
      const link = DeepLink.getLink({ facet: name });
      log('info', 'Accessed ' + name + ' facet');
      const confirmed = confirm(
        name + ' Facet\n\n' +
        descs[name] + '\n\n' +
        'Status: Active\n\n' +
        'Direct link:\n' + link + '\n\n' +
        'Copy link to clipboard?'
      );
      if (confirmed) {
        navigator.clipboard.writeText(link).then(function() {
          log('info', 'Copied deep link for ' + name + ' facet');
        });
      }
      history.replaceState(null, '', DeepLink.generate({ facet: name }));
    }

    // Update help to include deep link info
    function showHelp() {
      alert(
        'Genesis Control Panel - Quick Guide\n\n' +
        'PENTAGON: Click any of the 5 main functions to access them\n\n' +
        'LAYERS: Click a layer header to expand and see its rooms\n\n' +
        'ROOMS: Click any room to check its status\n\n' +
        'LOG: Activity is recorded at the bottom of the page\n\n' +
        'DEV SETTINGS: Click the wrench icon for developer options\n\n' +
        'DEEP LINKS: Share direct links to any room or facet!\n' +
        '  #room=Thermostat - Link to a room\n' +
        '  #facet=CMD - Link to a facet\n' +
        '  #layer=0 - Open a layer\n\n' +
        'Need more help? Contact your system administrator.'
      );
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // DEVELOPER PANEL - iOS Developer Settings patterns
    // prefs:root=DEVELOPER_SETTINGS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    const devPanel = document.getElementById('devPanel');

    // Developer settings state (persisted to localStorage)
    const devSettings = JSON.parse(localStorage.getItem('genesis_dev_settings') || '{}');

    // Initialize toggle states from saved settings
    function initDevToggles() {
      document.querySelectorAll('.dev-toggle').forEach(function(toggle) {
        const setting = toggle.dataset.setting;
        if (devSettings[setting] !== undefined) {
          toggle.classList.toggle('on', devSettings[setting]);
        }
      });
    }
    initDevToggles();

    // Toggle dev panel visibility
    function toggleDevPanel() {
      devPanel.classList.toggle('show');
      if (devPanel.classList.contains('show')) {
        log('info', 'Developer Settings opened');
      }
    }

    // Close on backdrop click
    devPanel.onclick = function(e) {
      if (e.target === devPanel) {
        toggleDevPanel();
      }
    };

    // Toggle individual setting
    function toggleSetting(el) {
      el.classList.toggle('on');
      const setting = el.dataset.setting;
      const enabled = el.classList.contains('on');
      devSettings[setting] = enabled;
      localStorage.setItem('genesis_dev_settings', JSON.stringify(devSettings));

      log(enabled ? 'info' : 'warn', 'Dev: ' + formatSettingName(setting) + ' ' + (enabled ? 'enabled' : 'disabled'));

      // Special handling for certain settings
      if (setting === 'verboseLog' && enabled) {
        log('info', 'Verbose logging active - all debug messages will be shown');
      }
      if (setting === 'networkConditioner' && enabled) {
        log('warn', 'Network conditioner active - requests may be slow');
      }
      if (setting === 'bypassAuth' && enabled) {
        log('warn', 'Auth bypass active - NOT FOR PRODUCTION');
      }
    }

    // Format setting name for display
    function formatSettingName(setting) {
      return setting
        .replace(/([A-Z])/g, ' $1')
        .replace(/^./, function(s) { return s.toUpperCase(); });
    }

    // Dev action handlers
    function devAction(action) {
      switch (action) {
        case 'clearTrusted':
          if (confirm('Clear all trusted computers?\n\nYou will need to re-authorize devices on next connection.')) {
            log('warn', 'Dev: Cleared trusted computers list');
            alert('Trusted computers cleared.');
          }
          break;

        case 'resetLocalData':
          if (confirm('Reset local data?\n\nThis will clear cached data but preserve settings.')) {
            sessionStorage.clear();
            log('warn', 'Dev: Local data reset');
            alert('Local data cleared.');
          }
          break;

        case 'resetSettings':
          if (confirm('Reset all settings to defaults?\n\nThis cannot be undone.')) {
            localStorage.removeItem('genesis_dev_settings');
            Object.keys(devSettings).forEach(function(k) { delete devSettings[k]; });
            initDevToggles();
            log('warn', 'Dev: All settings reset to defaults');
            alert('Settings reset to defaults.');
          }
          break;

        case 'factoryReset':
          if (confirm('âš ï¸ FACTORY RESET âš ï¸\n\nThis will:\n- Clear all local data\n- Reset all settings\n- Sign you out\n\nAre you absolutely sure?')) {
            if (confirm('This is your final warning.\n\nProceed with factory reset?')) {
              localStorage.clear();
              sessionStorage.clear();
              log('error', 'Dev: Factory reset initiated');
              alert('Factory reset complete.\n\nPage will reload.');
              location.reload();
            }
          }
          break;
      }
    }

    // Keyboard shortcut to open dev panel (Cmd+Shift+D / Ctrl+Shift+D)
    document.addEventListener('keydown', function(e) {
      if ((e.metaKey || e.ctrlKey) && e.shiftKey && e.key === 'D') {
        e.preventDefault();
        if (dashboardEl.classList.contains('show')) {
          toggleDevPanel();
        }
      }
    });

    // Deep link support for dev panel
    if (window.location.hash.includes('dev')) {
      DeepLink.pending = DeepLink.pending || {};
      DeepLink.pending.dev = true;
    }

    // Extend DeepLink.navigate to handle dev panel
    const originalNavigate = DeepLink.navigate;
    DeepLink.navigate = function(params) {
      originalNavigate.call(DeepLink, params);
      if (params.dev) {
        toggleDevPanel();
      }
      if (params.settings) {
        toggleSettings();
      }
    };

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // TOAST NOTIFICATIONS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    const toastContainer = document.getElementById('toastContainer');

    function toast(type, title, message) {
      const appSettings = JSON.parse(localStorage.getItem('genesis_app_settings') || '{}');
      if (appSettings.showToasts === false) return;

      const icons = {
        success: 'âœ“',
        error: 'âœ•',
        warning: 'âš ',
        info: 'â„¹'
      };

      const toastEl = document.createElement('div');
      toastEl.className = 'toast';
      toastEl.innerHTML = `
        <div class="toast-icon ${type}">${icons[type]}</div>
        <div class="toast-content">
          <div class="toast-title">${title}</div>
          <div class="toast-message">${message}</div>
        </div>
        <button class="toast-close" onclick="this.parentElement.remove()">Ã—</button>
      `;

      toastContainer.appendChild(toastEl);

      // Auto-remove after 4 seconds
      setTimeout(function() {
        toastEl.classList.add('hide');
        setTimeout(function() {
          toastEl.remove();
        }, 300);
      }, 4000);
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ROOM MODAL
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    const roomModal = document.getElementById('roomModal');
    let currentRoomData = null;

    // Room metadata
    const roomData = {
      // Layer 0 - Kernel
      Thermostat: { icon: 'ğŸŒ¡ï¸', layer: 0, layerName: 'Kernel', desc: 'Temperature monitoring' },
      Chip: { icon: 'ğŸ”²', layer: 0, layerName: 'Kernel', desc: 'Processing unit' },
      Battery: { icon: 'ğŸ”‹', layer: 0, layerName: 'Kernel', desc: 'Power management' },
      Clock: { icon: 'ğŸ•', layer: 0, layerName: 'Kernel', desc: 'Time synchronization' },
      Compass: { icon: 'ğŸ§­', layer: 0, layerName: 'Kernel', desc: 'Navigation core' },
      Fuse: { icon: 'âš¡', layer: 0, layerName: 'Kernel', desc: 'Circuit protection' },
      Spark: { icon: 'âœ¨', layer: 0, layerName: 'Kernel', desc: 'Ignition system' },
      // Layer 1 - Conduit
      Flares: { icon: 'ğŸ”¥', layer: 1, layerName: 'Conduit', desc: 'Alert signals' },
      Locks: { icon: 'ğŸ”’', layer: 1, layerName: 'Conduit', desc: 'Access control' },
      Doors: { icon: 'ğŸšª', layer: 1, layerName: 'Conduit', desc: 'Entry points' },
      Horn: { icon: 'ğŸ“¢', layer: 1, layerName: 'Conduit', desc: 'Announcements' },
      Mirrors: { icon: 'ğŸª', layer: 1, layerName: 'Conduit', desc: 'Reflection layer' },
      Antenna: { icon: 'ğŸ“¡', layer: 1, layerName: 'Conduit', desc: 'Signal broadcast' },
      Relay: { icon: 'ğŸ”„', layer: 1, layerName: 'Conduit', desc: 'Message routing' },
      // Layer 2 - Reservoir
      Trunk: { icon: 'ğŸ§³', layer: 2, layerName: 'Reservoir', desc: 'Primary storage' },
      Spares: { icon: 'ğŸ”§', layer: 2, layerName: 'Reservoir', desc: 'Backup components' },
      Coolant: { icon: 'â„ï¸', layer: 2, layerName: 'Reservoir', desc: 'Thermal regulation' },
      Wash: { icon: 'ğŸ’§', layer: 2, layerName: 'Reservoir', desc: 'Data cleansing' },
      Tank: { icon: 'â›½', layer: 2, layerName: 'Reservoir', desc: 'Resource pool' },
      Filter: { icon: 'ğŸ§¹', layer: 2, layerName: 'Reservoir', desc: 'Data filtering' },
      Jack: { icon: 'ğŸ”©', layer: 2, layerName: 'Reservoir', desc: 'Lift mechanism' },
      Glove: { icon: 'ğŸ§¤', layer: 2, layerName: 'Reservoir', desc: 'Secure handling' },
      // Layer 3 - Valve
      Brakes: { icon: 'ğŸ›‘', layer: 3, layerName: 'Valve', desc: 'Flow control' },
      Tint: { icon: 'ğŸ•¶ï¸', layer: 3, layerName: 'Valve', desc: 'Privacy layer' },
      Wipers: { icon: 'ğŸŒ§ï¸', layer: 3, layerName: 'Valve', desc: 'Data cleanup' },
      Fuel: { icon: 'â›½', layer: 3, layerName: 'Valve', desc: 'Resource allocation' },
      Clutch: { icon: 'âš™ï¸', layer: 3, layerName: 'Valve', desc: 'Engagement control' },
      Gears: { icon: 'âš™ï¸', layer: 3, layerName: 'Valve', desc: 'Speed regulation' },
      Pedals: { icon: 'ğŸ‘Ÿ', layer: 3, layerName: 'Valve', desc: 'Input controls' },
      Gauges: { icon: 'ğŸ“Š', layer: 3, layerName: 'Valve', desc: 'Metrics display' },
      Seatbelts: { icon: 'ğŸ”²', layer: 3, layerName: 'Valve', desc: 'Safety constraints' },
      // Layer 4 - Manifold
      Engine: { icon: 'ğŸš—', layer: 4, layerName: 'Manifold', desc: 'Core processor' },
      Wings: { icon: 'ğŸ¦…', layer: 4, layerName: 'Manifold', desc: 'Flight systems' },
      Mods: { icon: 'ğŸ”Œ', layer: 4, layerName: 'Manifold', desc: 'Extensions' },
      Exhaust: { icon: 'ğŸ’¨', layer: 4, layerName: 'Manifold', desc: 'Output stream' },
      Turbo: { icon: 'ğŸŒ€', layer: 4, layerName: 'Manifold', desc: 'Acceleration' },
      Chassis: { icon: 'ğŸ› ï¸', layer: 4, layerName: 'Manifold', desc: 'Framework' },
      Bumper: { icon: 'ğŸš™', layer: 4, layerName: 'Manifold', desc: 'Protection' },
      Spoiler: { icon: 'ğŸï¸', layer: 4, layerName: 'Manifold', desc: 'Stability' },
      Wheels: { icon: 'âšª', layer: 4, layerName: 'Manifold', desc: 'Motion' },
      Playroom: { icon: 'ğŸ¨', layer: 4, layerName: 'Manifold', desc: 'Creative sandbox' }
    };

    // Enhanced openRoom function
    function openRoom(name) {
      const data = roomData[name] || { icon: 'ğŸ“¦', layer: 0, layerName: 'Unknown', desc: 'Room' };
      currentRoomData = { name: name, ...data };

      document.getElementById('roomModalIcon').textContent = data.icon;
      document.getElementById('roomModalName').textContent = name;
      document.getElementById('roomModalLayer').textContent = `Layer ${data.layer} - ${data.layerName}`;
      document.getElementById('roomModalStatus').textContent = 'Online';
      document.getElementById('roomModalUptime').textContent = (95 + Math.random() * 5).toFixed(1) + '%';
      document.getElementById('roomModalLastCheck').textContent = 'Just now';
      document.getElementById('roomModalMessages').textContent = Math.floor(Math.random() * 5000).toLocaleString();

      roomModal.classList.add('show');
      log('info', 'Opened room: ' + name);

      history.replaceState(null, '', DeepLink.generate({ room: name }));
    }

    function closeRoomModal() {
      roomModal.classList.remove('show');
      currentRoomData = null;
    }

    function copyRoomLink() {
      if (!currentRoomData) return;
      const link = DeepLink.getLink({ room: currentRoomData.name });
      navigator.clipboard.writeText(link).then(function() {
        toast('success', 'Link Copied', 'Direct link to ' + currentRoomData.name + ' copied');
        log('info', 'Copied deep link for ' + currentRoomData.name);
      });
    }

    function refreshRoom() {
      if (!currentRoomData) return;
      document.getElementById('roomModalLastCheck').textContent = 'Refreshing...';
      setTimeout(function() {
        document.getElementById('roomModalLastCheck').textContent = 'Just now';
        document.getElementById('roomModalUptime').textContent = (95 + Math.random() * 5).toFixed(1) + '%';
        toast('success', 'Status Updated', currentRoomData.name + ' is online');
        log('info', currentRoomData.name + ' status refreshed');
      }, 500);
    }

    // Close modal on backdrop click
    roomModal.onclick = function(e) {
      if (e.target === roomModal) {
        closeRoomModal();
      }
    };

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // SETTINGS PANEL
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    const settingsPanel = document.getElementById('settingsPanel');
    const appSettings = JSON.parse(localStorage.getItem('genesis_app_settings') || '{"showToasts": true, "autoRefresh": true, "layerPreviews": true, "animations": true}');

    // Initialize settings toggles
    function initAppSettings() {
      document.querySelectorAll('.settings-toggle').forEach(function(toggle) {
        const setting = toggle.dataset.setting;
        if (appSettings[setting] !== undefined) {
          toggle.classList.toggle('on', appSettings[setting]);
        }
      });
    }
    initAppSettings();

    function toggleSettings() {
      settingsPanel.classList.toggle('show');
      if (settingsPanel.classList.contains('show')) {
        log('info', 'Settings opened');
      }
    }

    // Close on backdrop click
    settingsPanel.onclick = function(e) {
      if (e.target === settingsPanel) {
        toggleSettings();
      }
    };

    function toggleAppSetting(el) {
      el.classList.toggle('on');
      const setting = el.dataset.setting;
      const enabled = el.classList.contains('on');
      appSettings[setting] = enabled;
      localStorage.setItem('genesis_app_settings', JSON.stringify(appSettings));

      toast('info', 'Setting Updated', formatSettingName(setting) + ' ' + (enabled ? 'enabled' : 'disabled'));
      log('info', 'Setting: ' + formatSettingName(setting) + ' ' + (enabled ? 'enabled' : 'disabled'));

      // Apply animation setting immediately
      if (setting === 'animations') {
        document.body.style.setProperty('--animation-duration', enabled ? '0.3s' : '0s');
      }
    }

    function setTheme(theme) {
      document.querySelectorAll('.theme-option').forEach(function(el) {
        el.classList.toggle('active', el.dataset.theme === theme);
      });
      appSettings.theme = theme;
      localStorage.setItem('genesis_app_settings', JSON.stringify(appSettings));
      toast('info', 'Theme Changed', 'Switched to ' + theme + ' theme');
      log('info', 'Theme set to ' + theme);
      // Theme implementation would go here
    }

    // Keyboard shortcut for settings (Cmd+, / Ctrl+,)
    document.addEventListener('keydown', function(e) {
      if ((e.metaKey || e.ctrlKey) && e.key === ',') {
        e.preventDefault();
        if (dashboardEl.classList.contains('show')) {
          toggleSettings();
        }
      }
      // ESC to close modals
      if (e.key === 'Escape') {
        if (roomModal.classList.contains('show')) closeRoomModal();
        if (settingsPanel.classList.contains('show')) toggleSettings();
        if (devPanel.classList.contains('show')) toggleDevPanel();
      }
    });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // LOG FILTERING
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    let currentLogFilter = 'all';

    function filterLog(filter) {
      currentLogFilter = filter;

      // Update active button
      document.querySelectorAll('.log-filter').forEach(function(btn) {
        btn.classList.toggle('active', btn.dataset.filter === filter);
      });

      // Filter entries
      document.querySelectorAll('.log-entry').forEach(function(entry) {
        const msg = entry.querySelector('.log-msg');
        if (filter === 'all') {
          entry.style.display = '';
        } else {
          entry.style.display = msg.classList.contains(filter) ? '' : 'none';
        }
      });

      log('info', 'Log filter: ' + filter);
    }

    function clearLog() {
      logBody.innerHTML = '';
      log('info', 'Log cleared');
      toast('info', 'Log Cleared', 'Activity log has been cleared');
    }

    // Enhanced log function with filtering
    const originalLog = log;
    function log(type, message) {
      const time = new Date().toLocaleTimeString('en-AU', { hour12: false });
      const entry = document.createElement('div');
      entry.className = 'log-entry';
      entry.dataset.type = type;
      entry.innerHTML = '<span class="log-time">[' + time + ']</span> <span class="log-msg ' + type + '">' + message + '</span>';

      // Apply current filter
      if (currentLogFilter !== 'all' && type !== currentLogFilter) {
        entry.style.display = 'none';
      }

      logBody.appendChild(entry);
      logBody.scrollTop = logBody.scrollHeight;
    }

    // Welcome toast after login
    const origLogin = loginBtn.onclick;
    loginBtn.onclick = function() {
      const wasLoggedOut = !dashboardEl.classList.contains('show');
      origLogin.call(this);
      if (wasLoggedOut && dashboardEl.classList.contains('show')) {
        setTimeout(function() {
          toast('success', 'Welcome Back', 'Signed in as ' + uidEl.value);
        }, 500);
      }
    };
  </script>
</body>
</html>
